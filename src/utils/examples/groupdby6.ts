const data = [
  {
    'material_id': 'gold',
    'metal_purity': '18k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '20k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '18k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '20k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '18k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '20k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '18k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '20k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '18k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'gold',
    'metal_purity': '20k',
    'qty': 10,
    'net_weight': 11,
    'pure_weight': 12,
    'diamond_weight': 13,
    'colorstone_weight': 14
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '18k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  },
  {
    'material_id': 'silver',
    'metal_purity': '20k',
    'qty': 20,
    'net_weight': 21,
    'pure_weight': 22,
    'diamond_weight': 23,
    'colorstone_weight': 24
  }
];

/*
 * https://jsfiddle.net/hqxff9Ld/6/
 * in 6 you see all values of a column while in 5 you see the values of a row.
 * also 6 is slower of course
 */

// Original pen: https://codepen.io/puresourl/pen/bawzQg
const first = (values) => values[0];
const sum = (values) => values.reduce((a, b) => a + b, 0);

console.log(aggregate(groupBy(data, 'material_id', 'metal_purity'), {
  'material_id': first,
  'metal_purity': first,
  'qty': sum,
  'net_weight': sum,
  'pure_weight': sum,
  'diamond_weight': sum,
  'colorstone_weight': sum
}));

function aggregate(groups, fields) {
  return groups.map((group) => {
    const aggregate = {};
    Object.entries(fields).forEach(([key, fun]) => aggregate[key] = fun(group.map((element) => element[key])));
    return aggregate;
  });
}

function groupBy(elements, ...keys) {
  const groups = [];
  elements.forEach((element) => {
    let group = groups.find((group) => keys.every((key) => group[0][key] === element[key]));
    if (!group) {
      groups.push(group = []);
    }
    group.push(element);
  });
  return groups;
}
